### 📌Chapter2-电商系统

#### 🔻订单系统概述和难点
        🔸概述：订单系统是电商系统中的核心节点 也是最复杂的一个系统
        
        🔸难点：数据一致性 系统可用性 高并发场景

#### 🔻订单系统核心功能
    🔸核心功能：创单、更新订单状态、查询订单列表和订单详情
   
    🔸数据表：订单表、商品表、优惠券表、支付表等

#### 🔻创建订单-重复提交问题
    🔸背景：用户下单后 因为网络原因或者rpc重试机制 同一时间有两个一模一样的请求到后台
   
    🔸解决方法：服务具备幂等性—利用数据库主键的唯一约束: 调用生成订单号服务生产一个唯一订单id➕订单id的唯一约束

#### 🔻修改订单-ABA问题
    🔸背景：并发修改信息的情况下 因为响应消息在网络中丢失 导致旧的请求重发 最终导致修改错误 覆盖了正确的修改
   
    🔸解决方法：幂等性: 加版本号 每次修改前判断版本号 如果成功则版本号加1

#### 🔻总结
    🔸使用数据库主键的唯一约束解决重复提交问题
   
    🔸使用乐观锁：版本号解决并发修改导致的ABA问题

#### 🔻泛化
    🔸解决幂等性问题的方案: 数据库唯一约束、乐观锁、分布式锁
   
    🔸实际问题中要考虑到并发修改问题、网络延迟问题、重试机制等极端问题

#### 🔻实践
    🔸使用过乐观锁(版本号)解决并发修改问题
   
    🔸使用Redis的分布式锁解决并发修改问题
